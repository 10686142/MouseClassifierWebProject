(this.webpackJsonpfrontend_react=this.webpackJsonpfrontend_react||[]).push([[0],{21:function(e,t,n){e.exports=n(32)},26:function(e,t,n){},27:function(e,t,n){},29:function(e,t,n){},32:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n.n(r),s=n(19),o=n.n(s),i=(n(26),n(2)),c=n(5),l=n(3),u=n(4),d=(n(27),n(7)),m=n.n(d),v=n(14),g=n(8),h=n(1),p=n(34),f=n(17),y=n(20),k=(n(29),function(e){var t=Object(r.useState)(0),n=Object(y.a)(t,2),s=n[0],o=n[1],i=Object(r.useRef)(null),c=e.size,l=e.progress,u=e.strokeWidth,d=e.circleOneStroke,m=e.circleTwoStroke,v=c/2,g=c/2-u/2,h=2*Math.PI*g;return Object(r.useEffect)((function(){o((100-l)/100*h),i.current.style="transition: stroke-dashoffset 850ms ease-in-out"}),[o,l,h,s]),a.a.createElement(a.a.Fragment,null,a.a.createElement("svg",{className:"svg",width:c,height:c},a.a.createElement("circle",{className:"svg-circle-bg",stroke:d,cx:v,cy:v,r:g,strokeWidth:u}),a.a.createElement("circle",{className:"svg-circle",ref:i,stroke:m,cx:v,cy:v,r:g,strokeWidth:u,strokeDasharray:h,strokeDashoffset:s}),a.a.createElement("text",{x:"".concat(v),y:"".concat(v),className:"svg-circle-text"},l,"%")))}),b=n(15),w=function(e){Object(l.a)(n,e);var t=Object(u.a)(n);function n(e){var r;return Object(i.a)(this,n),(r=t.call(this,e)).notMobileAlert=function(){setTimeout((function(){alert("This web can only be used on mobile, since it needs access to the gyroscope and accelator..")}),1e3)},r.startDataInterval=function(){var e=setInterval(r.handleDataTransmission,r.state.dataPeriod);r.setState({interval:e})},r.handleDataTransmission=function(){var e=r.state.sr_no+1,t=r.state.msInterval+r.state.dataPeriod,n=r.state.hostTime+r.state.dataPeriod,a=r.state.nodeTime+r.state.dataPeriod/10;if(r.setState({msInterval:t,sr_no:e,hostTime:n,nodeTime:a}),document.getElementById("intervalSeconds").innerHTML=t+"ms",console.log(t),t<2e3){var s=r.state.currentData;s.sr_no=e,s.msInterval=t,s.hostTime=n,s.nodeTime=a,console.log(s),r.sendDataUpstream(s,!1)}else r.stopAll()},r.stopAll=function(){clearInterval(r.state.interval),r.sendDataUpstream({},!0),r.setState({resultMovement:"Waiting for results..."}),r.stopTrackingSensors();r.setState(Object(g.a)(Object(g.a)({},r.state),{},{currentData:{x_acc:0,y_acc:0,z_acc:0,x_gyr:0,y_gyr:0,z_gyr:0}})),r.setState({msInterval:0,sr_no:0,hostTime:156162,nodeTime:29922})},r.sendDataUpstream=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];r.state.webSocket.send(JSON.stringify({last_one:t,is_message:n,data:e}))},r.startCountDown=function(){var e=4,t=setInterval(function(){e--;var n="Tracking starts in: ".concat(e);this.setState({resultMovement:n}),e<=0&&(clearInterval(t),this.startMovement(),this.startDataInterval())}.bind(Object(h.a)(r)),1e3)},r.startMovement=function(){r.setState({resultMovement:"Tracking...."}),r.state.gyrSensor.addEventListener("reading",r.readGyr),r.state.accSensor.addEventListener("reading",r.readAcc),r.state.gyrSensor.start(),r.state.accSensor.start()},r.readGyr=function(e){r.setState(Object(g.a)(Object(g.a)({},r.state.currentData),{},{x_gyr:+e.target.x.toFixed(2),y_gyr:+e.target.y.toFixed(2),z_gyr:+e.target.z.toFixed(2)})),console.log(),document.getElementById("statusGyr").innerHTML="x: ".concat(+e.target.x.toFixed(2),", y: ").concat(+e.target.y.toFixed(2),", z: ").concat(+e.target.z.toFixed(2))},r.readAcc=function(e){r.setState(Object(g.a)(Object(g.a)({},r.state.currentData),{},{x_acc:100*e.target.x.toFixed(2),y_acc:100*e.target.y.toFixed(2),z_acc:100*e.target.z.toFixed(2)})),document.getElementById("statusAcc").innerHTML="x: ".concat(100*e.target.x,", y: ").concat(100*e.target.y,", z: ").concat(100*e.target.z)},r.stopTrackingSensors=function(){r.state.gyrSensor.stop(),r.state.accSensor.stop(),r.state.gyrSensor.removeEventListener("reading",r.readGyr),r.state.accSensor.removeEventListener("reading",r.readAcc)},r.state={isTracking:!1,listnersAdded:!1,deviceMotionPermission:!1,deviceOrientationPermission:!1,isSendingData:!1,accSensor:new f.a({frequency:13}),gyrSensor:new f.b({frequency:15}),webSocket:{},messages:[],dataPeriod:50,msInterval:0,sr_no:0,hostTime:156162,nodeTime:29922,currentData:{x_acc:0,y_acc:0,z_acc:0,x_gyr:0,y_gyr:0,z_gyr:0},interval:{},resultAccuracy:0,resultMovement:"",resultColor:"#d9edfe",colorDefault:"#d9edfe",colorGood:"#4FFF33",colorMedium:"#A2E766",colorBad:"#F06925"},r}return Object(c.a)(n,[{key:"componentDidMount",value:function(){this.setupWebSocket(),this.startTracking=this.startTracking.bind(this),!b.isMobile&&this.props.is_production&&this.notMobileAlert()}},{key:"setupWebSocket",value:function(){var e=this,t=this.props.is_production?"mcwp.vsc.app/":"localhost",n=new WebSocket("wss://"+t+":8000/");this.setState({webSocket:n}),n.onmessage=function(t){var n=JSON.parse(t.data);console.log(n);var r=+(100*n.accuracy).toFixed(0),a=r>70?e.state.colorGood:e.state.colorMedium;r<50&&(a=e.state.colorBad),e.setState({resultAccuracy:r,resultMovement:n.movement,resultColor:a,isTracking:!1})},n.onclose=function(e){console.error("Chat socket closed unexpectedly"),console.error(e)}}},{key:"requestDeviceMotionPermission",value:function(){var e=Object(v.a)(m.a.mark((function e(){var t=this;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("function"!==typeof DeviceMotionEvent.requestPermission){e.next=5;break}return e.next=3,DeviceMotionEvent.requestPermission().then((function(e){"granted"===e&&(console.log("Device Motion granted"),t.setState({deviceMotionPermission:!0}))})).catch(console.error);case 3:e.next=6;break;case 5:console.log("Non ios 13 device");case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"requestDeviceOrientationPermission",value:function(){var e=Object(v.a)(m.a.mark((function e(){var t=this;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("function"!==typeof DeviceOrientationEvent.requestPermission){e.next=5;break}return e.next=3,DeviceOrientationEvent.requestPermission().then((function(e){"granted"===e&&(console.log("Device Orientation granted"),t.setState({deviceOrientationPermission:!0}))})).catch(console.error);case 3:e.next=6;break;case 5:console.log("Non ios 13 device");case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"startTracking",value:function(){var e=Object(v.a)(m.a.mark((function e(){return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(b.isMobile||!this.props.is_production){e.next=4;break}this.notMobileAlert(),e.next=12;break;case 4:if(this.setState({resultAccuracy:0,resultMovement:"",resultColor:this.state.colorDefault,isTracking:!0}),this.sendDataUpstream({message:"Tracking starts.."},!1,!0),this.state.deviceMotionPermission&&this.state.deviceOrientationPermission){e.next=11;break}return e.next=9,this.requestDeviceMotionPermission();case 9:return e.next=11,this.requestDeviceOrientationPermission();case 11:this.startCountDown();case 12:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this.state.isTracking?"Disabled":"Start";return a.a.createElement("div",{className:"dark-vazkir"},a.a.createElement("p",{id:"statusGyr"},"Gyroscope waiting..."),a.a.createElement("p",{id:"statusAcc"},"Accelerometer waiting..."),a.a.createElement("p",{id:"intervalSeconds"},"0ms"),a.a.createElement("div",{className:"center"},a.a.createElement(k,{progress:this.state.resultAccuracy,size:220,strokeWidth:15,circleOneStroke:this.state.colorDefault,circleTwoStroke:this.state.resultColor}),a.a.createElement("h3",null,this.state.resultMovement),a.a.createElement("br",null),a.a.createElement(p.a,{disabled:this.state.isTracking,variant:"success",size:"lg",style:{width:"14rem",height:"3rem"},onClick:this.state.isTracking?this.stopAll:this.startTracking},e)))}}]),n}(r.Component),x=function(e){Object(l.a)(n,e);var t=Object(u.a)(n);function n(){return Object(i.a)(this,n),t.apply(this,arguments)}return Object(c.a)(n,[{key:"render",value:function(){return a.a.createElement("div",{className:"App dark-vazkir"},a.a.createElement(w,{is_production:this.props.is_production}))}}]),n}(r.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));n(31);window.component=window.component||"App",window.reactRoot=window.reactRoot||document.getElementById("react"),window.props=window.props||{};var S="is_production"in window.props&&!!window.props.is_production;window.props.ref=function(e){window.reactComponent=e},o.a.render(a.a.createElement(x,{is_production:S}),document.getElementById("react")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[21,1,2]]]);
//# sourceMappingURL=main.521b4737.chunk.js.map